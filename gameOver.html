<html>
<script src="https://www.gstatic.com/firebasejs/4.3.1/firebase.js"></script>
<title>you_lose</title>
<link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Disc_Plain_red.svg/2000px-Disc_Plain_red.svg.png" />
<style>

body{
  background-color: black;
}

div, p, h1, h2 {
  color: rgb(0,255,0);
  font-family: 'Courier new', 'Courier';
}

input {
  font-family: 'Courier new', 'Courier';
  font-size: 15px;
  color: rgb(0,255,0);
  background-color: black;
  border: 1px solid rgb(0,255,0);
}

form {
  font-family: 'Courier new', 'Courier';
  color: rgb(0,255,0);
  background: black;
}

</style>
<h1>Game Over!</h1>



<body>

<script>
  // init firebase
  var config = {
    apiKey: "AIzaSyCA6Skvl_GCuFi_7x1gnkUd4GZAltnBIwo",
    authDomain: "kj-hackthenorth.firebaseapp.com",
    databaseURL: "https://kj-hackthenorth.firebaseio.com",
    projectId: "kj-hackthenorth",
    storageBucket: "kj-hackthenorth.appspot.com",
    messagingSenderId: "292024454192"
  };

  firebase.initializeApp(config);
  var scorelist = [];
  var justplayed;
  var database = firebase.database();
  var printthis = "";
  var ref = database.ref('scores');
  var len = 0;
  ref.on('value', gotData, errData);

  function gotData(data) {
    var scores = data.val();
    var keys = Object.keys(scores);
    for(var i = 0; i < keys.length; i++) {
      var k = keys[i];
      var user = scores[k].name;
      var userscore = scores[k].score;
      scorelist.push(userscore + " - " + user);
    }

    justplayed = scorelist[scorelist.length-1];

    if(scorelist.length>10) len = 10;
    else len = scorelist.length;

    var collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});

    scorelist.sort(collator.compare).reverse();

    for(var j = 0; j<len; j++) {
      printthis += "<ol>" + scorelist[j] + "</ol>";
    }

    document.getElementById('yourscore').innerHTML = justplayed;
    document.getElementById('display').innerHTML = printthis;

  }

  function errData(err) {
    console.log('Error!');
    console.log(err);
  }


</script>
<div id='yourscore'>

</div>
<h2>
Top 10 Highscores:
</h2>

<div id='display'>

</div>
<input type="button" value="Try again?" onclick="window.location.replace('index.html')"/>
</body>
</html>
